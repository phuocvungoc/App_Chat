<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Cache-control" content="no-cache">
    <meta http-equiv="Cache" content="no-cache">
    <meta content="telephone=no" name="format-detection">
    <meta name="description" content="a shop from vietnam.">
    <link rel="icon" href="" type="image/x-icon">
    <link rel="shortcut icon" href="" type="image/x-icon">
    <!--CSS-->
    <link href="/css/vantjs.css" rel="stylesheet">
    <link href="/css/vendor.css" rel="stylesheet">
    <link href="/css/main.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/app.css">
    <link rel="stylesheet" type="text/css" href="/css/pages__member.css">
    <link rel="stylesheet" href="/css/style.css">
    <title>Modify payment password</title>
    <style>
        .preloader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #fff;
            z-index: 99;
        }
    </style>
</head>

<body>
    <div class="preloader"></div>
    <div data-v-58c67bb8="" class="layout-content">
        <!---->
        <div data-v-26ecfe4b="">
            <div data-v-26ecfe4b="">
                <div data-v-26ecfe4b="" class="van-nav-bar van-nav-bar--fixed">
                    <a href="Security">
                        <div class="van-nav-bar__left"><i class="van-icon van-icon-arrow-left van-nav-bar__arrow"><!----></i></div>
                    </a>
                    <div class="van-nav-bar__title van-ellipsis">Thay đổi mật khẩu thanh toán</div>
                    <div class="van-nav-bar__right"></div>
                </div>
                <div data-v-26ecfe4b="" class="bar-box"></div>
                <div data-v-26ecfe4b="" class="top">
                    <div data-v-26ecfe4b="" class="top-title">Thay đổi mật khẩu thanh toán</div>
                </div>
                <div data-v-26ecfe4b="" class="van-cell-group van-hairline--top-bottom" style="margin: 0px 24px;">
                    <!---->
                    <div data-v-26ecfe4b="" class="van-cell van-cell--center van-field">
                        <div class="van-field__left-icon"><i class="van-icon van-icon-comment"><!----></i></div>
                        <div class="van-cell__value van-cell__value--alone van-field__value">
                            <div class="van-field__body">
                                <input type="password" placeholder="Vui lòng nhập mật khẩu tài khoản" class="van-field__control van-field__controlPaymentOTP">
                            </div>
                        </div>
                    </div>
                    <div data-v-26ecfe4b="" class="van-cell van-field" style="font-size: 16px;">
                        <div class="van-field__left-icon"><i class="van-icon van-icon-lock"><!----></i></div>
                        <div class="van-cell__value van-cell__value--alone van-field__value">
                            <div class="van-field__body">
                                <input type="password" placeholder="Vui lòng nhập mật khẩu mới." class="van-field__control van-field__controlPayment1">
                            </div>
                        </div>
                    </div>
                    <div data-v-26ecfe4b="" class="van-cell van-field" style="font-size: 16px;">
                        <div class="van-field__left-icon"><i class="van-icon van-icon-lock"><!----></i></div>
                        <div class="van-cell__value van-cell__value--alone van-field__value">
                            <div class="van-field__body">
                                <input type="password" placeholder="Vui lòng xác nhận mật khẩu." class="van-field__control van-field__controlPayment2">
                            </div>
                        </div>
                    </div>
                </div>
                <div data-v-26ecfe4b="" style="padding: 0px 24px;">
                    <button data-v-26ecfe4b="" class="van-button van-button--default van-button--large van-button--largePayment" style="background-color: rgb(0, 184, 169); border-radius: 5px; color: rgb(255, 255, 255); margin-top: 20px;">
                        <div data-v-26ecfe4b="" class="van-button__content">
                            <span data-v-26ecfe4b="" class="van-button__text">Gửi</span>
                        </div>
                    </button>
                </div>
                <div data-v-26ecfe4b="" class="popup-password">Tip:mật khẩu không khớp, đề phòng bị trộm, trương hợp tổn thất tài sản do mất mật khẩu hê thống không chịu trách nhiệm</div>
            </div>
        </div>
    </div>
    <style>
        .display-none {
            display: none;
        }
    </style>
    <div class="van-toast van-toast--middle van-toast--loading display-none" style="z-index: 2003;">
        <div class="van-loading van-loading--circular van-toast__loading" style="line-height: 0;">
            <span class="van-loading__spinner van-loading__spinner--circular">
                <svg viewBox="25 25 50 50" class="van-loading__circular">
                    <circle cx="50" cy="50" r="20" fill="none"></circle>
                </svg>
            </span>
        </div>
        <div class="van-toast__text">Đang tải</div>
    </div>
    <div class="van-toast van-toast--middle van-toast--fail display-none" style="z-index: 2006">
        <i class="van-icon van-icon-fail van-toast__icon"><!----></i>
        <div class="van-toast__text"></div>
    </div>
    <div class="van-toast van-toast--middle van-toast--text display-none" style="z-index: 2001;">
        <div class="van-toast__text"></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(window).on('load', function() {
            $('.preloader').fadeOut('fast');
        });
        $(document).ready(function() {
            $('.van-button--largePayment').click(function() {
                var controlPaymentOTP = $('.van-field__controlPaymentOTP').val().trim();
                var controlPayment1 = $('.van-field__controlPayment1').val().trim();
                var controlPayment2 = $('.van-field__controlPayment2').val().trim();
                if (controlPaymentOTP != "" && controlPayment1 != "" && controlPayment2 != "" && controlPayment1 == controlPayment2) {
                    $.ajax({
                        type: "POST",
                        url: "/member/ChangePaymentPassword",
                        data: {
                            controlPaymentOTP: controlPaymentOTP,
                            controlPayment1: controlPayment1,
                        },
                        dataType: "json",
                        success: function(response) {
                            if (response.message == 1) {
                                $('.van-toast--text').removeClass('display-none');
                                $('.van-toast--text .van-toast__text').html('Đổi mật khẩu thành công.');
                                setTimeout(function() {
                                    $('.van-toast--text').addClass('display-none');
                                    window.location = "/member/index"
                                }, 1200)
                            } else if (response.message == 0) {
                                $('.van-toast--text').removeClass('display-none');
                                $('.van-toast--text .van-toast__text').html('Sai mật khẩu tài khoản');
                                setTimeout(function() {
                                    $('.van-toast--text').addClass('display-none')
                                }, 1000)
                            }
                        }
                    })
                } else if (controlPaymentOTP == "") {
                    $('.van-toast--text').removeClass('display-none');
                    $('.van-toast--text .van-toast__text').text('Mật khẩu tài khoản không được trống');
                    setTimeout(function() {
                        $('.van-toast--text').addClass('display-none')
                    }, 1000)
                } else if (controlPayment1 == "" || controlPayment2 == "") {
                    $('.van-toast--text').removeClass('display-none');
                    $('.van-toast--text .van-toast__text').text('Mật khẩu không được để trống.');
                    setTimeout(function() {
                        $('.van-toast--text').addClass('display-none')
                    }, 1000)
                } else if (controlPayment1 != controlPayment2) {
                    $('.van-toast--text').removeClass('display-none');
                    $('.van-toast--text .van-toast__text').text('Mật khẩu không trùng khớp.');
                    setTimeout(function() {
                        $('.van-toast--text').addClass('display-none')
                    }, 1000)
                }
            })
        });
        $(document).ready(function() {
            var counter = function() {
                var check_cownDown = localStorage.getItem("Cowndown");
                if (check_cownDown == null) {
                    $('.show_cowndown').html('<span data-v-5f483b78="" class="van-button__text" id="OTP">Mã OTP</span>');
                    $('.van-button--primary').removeAttr('disabled');
                    $('.van-button--primary').removeClass('van-button--disabled');
                    $("#OTP").html("Mã OTP");
                }
                if (check_cownDown < 2) {
                    localStorage.removeItem("Cowndown");
                    $('.show_cowndown').html('<span data-v-5f483b78="" class="van-button__text" id="OTP">Mã OTP</span>')
                }
                if (check_cownDown > 0) {
                    var value = check_cownDown;
                    value = parseInt(value) - 1;
                    localStorage.setItem("Cowndown", value);
                    $('.van-button--primary').attr('disabled', "disabled");
                    $('.van-button--primary').addClass('van-button--disabled');
                    $('.show_cowndown').html('<span data-v-5f483b78="" class="van-button__text" id="OTP"></span>');
                    document.getElementById('OTP').innerHTML = value + " giây";
                    document.getElementById("OTP").style.minWidth = "60.7px"
                }
            };
            setInterval(counter, 1000);
        });
        $(document).ready(function() {
            $('.send_otp').click(function() {
                var value = 60;
                localStorage.setItem("Cowndown", value);
                $.ajax({
                    type: "POST",
                    url: "/member/myBank",
                    dataType: "json",
                    data: {
                        grid_banking: "otp",
                    },
                    success: function(response) {
                        if (response.message == 1) {
                            $('.van-toast--loading').removeClass('display-none');
                            setTimeout(function() {
                                $('.van-toast--loading').addClass('display-none');
                                $('.van-toast--text').removeClass('display-none');
                                $('.van-toast--text .van-toast__text').html('Mã xác nhận đã gửi thành công');
                                $('body').removeClass('van-overflow-hidden');
                                setTimeout(function() {
                                    $('.van-toast--text').addClass('display-none')
                                }, 500)
                            }, 1300)
                        }
                    }
                })
            })
        });
    </script>
</body>

</html>